package com.OsMoDroid;import java.text.SimpleDateFormat;import java.util.ArrayList;import java.util.HashMap;import java.util.Arrays;import java.util.Iterator;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import com.OsMoDroid.GPSLocalServiceClient.RequestCommandTask;import android.app.Activity;import android.app.AlertDialog;import android.app.ListActivity;import android.content.Context;import android.content.DialogInterface;import android.content.Intent;import android.content.SharedPreferences;import android.os.Bundle;import android.preference.PreferenceManager;import android.text.ClipboardManager;import android.text.format.Time;import android.text.util.Linkify;import android.util.Log;import android.view.ContextMenu;import android.view.Menu;import android.view.ContextMenu.ContextMenuInfo;import android.view.MenuItem;import android.view.View;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.CheckBox;import android.widget.CompoundButton;import android.widget.AdapterView.AdapterContextMenuInfo;import android.widget.AdapterView.OnItemClickListener;import android.widget.CompoundButton.OnCheckedChangeListener;import android.widget.ArrayAdapter;import android.widget.Button;import android.widget.EditText;import android.widget.LinearLayout;import android.widget.ListView;import android.widget.TextView;import android.widget.Toast;public class MyChannelsDevices extends Activity implements ResultsListener{	 ListView lv1;	 SharedPreferences settings;		 final private static SimpleDateFormat sdf1 = new SimpleDateFormat("yyyy-mm-dd HH:mm:ss");	 //	public MyChannelsDevices() {		// TODO Auto-generated constructor stub	}		/** Called when the activity is first created. */	@Override	public void onCreate(Bundle savedInstanceState) {	    super.onCreate(savedInstanceState);	    setContentView(R.layout.mychannels);	    settings  = PreferenceManager.getDefaultSharedPreferences(this);	    lv1 = (ListView) findViewById(R.id.mychannelslistView);	       lv1.setAdapter(LocalService.channelsAdapter);	       if (LocalService.channelsAdapter!=null) {LocalService.channelsAdapter.notifyDataSetChanged();}	       registerForContextMenu(lv1);	  lv1.setOnItemClickListener(new OnItemClickListener() {		public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,				long arg3) {						arg0.showContextMenuForChild(arg1);						}	});	    Button refsimlinkbutton = (Button) findViewById(R.id.refreshchannelsbutton);	    refsimlinkbutton.setOnClickListener(new OnClickListener() {			public void onClick(View v) {				netutil.newapicommand((ResultsListener)LocalService.serContext, "om_device_channel_adaptive:"+settings.getString("device", ""));			}});	netutil.newapicommand((ResultsListener)LocalService.serContext, "om_device_channel_adaptive:"+settings.getString("device", ""));	}	 @Override	  public void onCreateContextMenu(ContextMenu menu, View v,	      ContextMenuInfo menuInfo) {	    super.onCreateContextMenu(menu, v, menuInfo);	    menu.add(0, 1, 0, "Исключить из канала").setIcon(android.R.drawable.ic_menu_share);;	  //  menu.add(0, 2, 0, "Проверить связь").setIcon(android.R.drawable.ic_menu_delete);;	  //  menu.add(0, 3, 0, "Проверить батарею").setIcon(android.R.drawable.ic_menu_edit);;	  }	  @Override	  public boolean onContextItemSelected(MenuItem item) {		  if (item.getItemId() == 1) {					    return super.onContextItemSelected(item);		  }		  return super.onContextItemSelected(item);	  }	public void onResultsSucceeded(APIComResult result) {				Log.d(getClass().getSimpleName(),"OnResultListener Command:"+result.Command+",Jo="+result.Jo);		if (!(result.Jo==null)  ) {			Toast.makeText(this,result.Jo.optString("state")+" "+ result.Jo.optString("error_description"),5).show();					}				}		}